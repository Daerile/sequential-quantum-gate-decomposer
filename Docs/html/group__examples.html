<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Sequential Quantum Gate Decomposer: Examples</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link rel="search" href="search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="Sequential Quantum Gate Decomposer"/>
<link href="QGD_customdoxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Sequential Quantum Gate Decomposer
   &#160;<span id="projectnumber">v1.5</span>
   </div>
   <div id="projectbrief">Powerful decomposition of general unitarias into one- and two-qubit gates gates</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,true,'search.php','Search');
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Examples</div>  </div>
</div><!--header-->
<div class="contents">
<p>Sequential Quantum <a class="el" href="class_gate.html" title="Base class for the representation of general gate operations. ">Gate</a> Decomposer (SQUANDER) package provides static and shared libraries (located in the directory <b>path/to/installed/qgd_python</b>) that can be linked againts our own C++ code. In the forthcoming sections we provide some tricks and best practices to use the SQUANDER API. Also, the SQUANDER API is supprted by a Doxygen documentation, which can be accessed trough the file <b>path/to/qgd/Docs/html/index.html</b>. (To build the Doxygen documentation follow the manual at <a href="index.html">Main Page</a>.)</p>
<p>A succesful build of the SQUANDER library can be tested by running the test cases in the <b>path/to/qgd/test_standalone</b> directory. (To build and install the SQUANDER package follow the manual at <a href="index.html">Main Page</a>).</p>
<p>The expected outcome of the test program <b><a class="el" href="decomposition__test_8cpp.html" title="A simple example file for a decomposition of general random unitaries. ">decomposition_test.cpp</a></b> should look as:</p>
  <style>div.image img[src="decomposition_test_result.png"]{width:1000px;}</style>  </p><div class="image">
<img src="decomposition_test_result.png" alt="decomposition_test_result.png"/>
<div class="caption">
Expected result for the 4th IBM Challenge problem</div></div>
<p> The output informs us that the 4-qubit unitary was decomposed by using 75 <a class="el" href="class_c_n_o_t.html" title="A class representing a CNOT operation. ">CNOT</a> gates with decomposition error 0.000316. These information are followed by the list of the decomposing operations.</p>
<h1>Using the SQUANDER library</h1>
<p>In this example we show how to use the SQUANDER library for developing applications using the decomposition capabilities of the SQUANDER package. Here we explain the steps provided in the example file <a class="el" href="decomposition__test_8cpp.html" title="A simple example file for a decomposition of general random unitaries. ">decomposition_test.cpp</a> to decompose a general random 4-qubit unitary.</p>
<p>To include the functionalities of the SQUANDER package, provide the following lines in your code:</p>
<div class="snippet"> <div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="common_8h.html">common.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="_n___qubit___decomposition_8h.html">N_Qubit_Decomposition.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="_random___unitary_8h.html">Random_Unitary.h</a>&quot;</span></div></div><!-- fragment --></div><p>The first include provide basic functionalities of the SQUANDER package, for example methods for aligned memory allocation and memory release. The second line includes the definition of the class to perform the decomposition of the N-qubit unitaries. This class is the key element to access the decomposition capabilities of the SQUANDER package. The third line imports the method and class definitions for creating random unitaries to be decomposed.</p>
<p>The SQUANDER package provides two ways to create random unitaries. The first way can be used to construct a random unitary as a product of <a class="el" href="class_c_n_o_t.html" title="A class representing a CNOT operation. ">CNOT</a> and <a class="el" href="class_u3.html" title="A class representing a U3 gate. ">U3</a> operations. The parameters of the operations are chosen randomly, but the overall number of <a class="el" href="class_c_n_o_t.html" title="A class representing a CNOT operation. ">CNOT</a> operations is predefined:</p>
<div class="snippet"> <div class="fragment"><div class="line">    <span class="comment">// The number of qubits spanning the random unitary</span></div><div class="line">    <span class="keywordtype">int</span> <a class="code" href="namespacesequential-quantum-gate-decomposer_1_1_c_h.html#a94a006c022e26d266fe4f6f500dda2e8">qbit_num</a> = 3;</div><div class="line"></div><div class="line">    <span class="comment">// the number of rows of the random unitary</span></div><div class="line">    <span class="keywordtype">int</span> <a class="code" href="namespacesequential-quantum-gate-decomposer_1_1_c_h.html#ad097cbd0876b8780bd682704cddf8691">matrix_size</a> = <a class="code" href="common_8cpp.html#a2085ad6d70ccf80dd353a70fe8262ff9">Power_of_2</a>(<a class="code" href="namespacesequential-quantum-gate-decomposer_1_1_c_h.html#a94a006c022e26d266fe4f6f500dda2e8">qbit_num</a>);</div><div class="line"></div><div class="line">    <span class="comment">// creating random unitary constructing from 6 CNOT gates.</span></div><div class="line">    <span class="keywordtype">int</span> cnot_num = 6;</div><div class="line">    <a class="code" href="class_matrix.html">Matrix</a> Umtx_few_CNOT = <a class="code" href="_random___unitary_8h.html#ac755edbef39273d53b90d33316963b37">few_CNOT_unitary</a>( <a class="code" href="namespacesequential-quantum-gate-decomposer_1_1_c_h.html#a94a006c022e26d266fe4f6f500dda2e8">qbit_num</a>, cnot_num);</div></div><!-- fragment --></div><p>The code snippet above demonstrates the way to create a random unitary describing <b>qbit_num</b> qubits and constructed from <b>cnot_num</b> number of <a class="el" href="class_c_n_o_t.html" title="A class representing a CNOT operation. ">CNOT</a> operations. The constructed unitary is returned through the preallocated <b>Umtx_few_CNOT</b> array. The second method can be used to construct general random unitaries based on the parametrization of <a href="https://arxiv.org/abs/1303.5904">arXiv:1303:5904v1</a>.</p>
<div class="snippet"> <div class="fragment"><div class="line">    <span class="comment">// creating class to generate general random unitary</span></div><div class="line">    <a class="code" href="class_random___unitary.html">Random_Unitary</a> ru = <a class="code" href="class_random___unitary.html">Random_Unitary</a>(<a class="code" href="namespacesequential-quantum-gate-decomposer_1_1_c_h.html#ad097cbd0876b8780bd682704cddf8691">matrix_size</a>);</div><div class="line">    <span class="comment">// create general random unitary</span></div><div class="line">    <a class="code" href="class_matrix.html">Matrix</a> <a class="code" href="namespacesequential-quantum-gate-decomposer_1_1_c_h.html#a68132298ae0db1508f56433d2f743108">Umtx</a> = ru.<a class="code" href="class_random___unitary.html#ab2efe5039bf7b2f0424d4bce4e3c66b4">Construct_Unitary_Matrix</a>();</div></div><!-- fragment --></div><p>After the creation of the unitary to be decomposed we create an instance of class <a class="el" href="class_n___qubit___decomposition.html" title="A base class to determine the decomposition of an N-qubit unitary into a sequence of CNOT and U3 gate...">N_Qubit_Decomposition</a> to perform further calculations:</p>
<div class="snippet"> <div class="fragment"><div class="line">    <span class="comment">// creating the class for the decomposition. Here Umtx_adj is the complex transposition of unitary Umtx</span></div><div class="line">    <a class="code" href="class_n___qubit___decomposition.html">N_Qubit_Decomposition</a> cDecomposition =</div><div class="line">                   <a class="code" href="class_n___qubit___decomposition.html">N_Qubit_Decomposition</a>( Umtx_adj, <a class="code" href="namespacesequential-quantum-gate-decomposer_1_1_c_h.html#a94a006c022e26d266fe4f6f500dda2e8">qbit_num</a>, <span class="comment">/* optimize_layer_num= */</span> <span class="keyword">false</span>, <span class="comment">/* initial_guess= */</span> <a class="code" href="_decomposition___base_8h.html#a0e76cf2e4eb5edbf067ba5014ffa2134aa2b65445a3a16f164c5e811064d75726">RANDOM</a> );</div></div><!-- fragment --></div><p>Notice, that we gave the complex transpose of the unitary Umtx as an input for the class <a class="el" href="class_n___qubit___decomposition.html" title="A base class to determine the decomposition of an N-qubit unitary into a sequence of CNOT and U3 gate...">N_Qubit_Decomposition</a>. This can be explained by simple linear algebra considerations: since the product of the unitary with it's complex transpose ( <img class="formulaInl" alt="$U U^\dagger=I$" src="form_0.png"/>) gives identity, the sequence of operations bringing a unitary <img class="formulaInl" alt="$U$" src="form_1.png"/> into identity would naturally equal to the complex transpose <img class="formulaInl" alt="$U^\dagger$" src="form_2.png"/> of the unitary <img class="formulaInl" alt="$U$" src="form_1.png"/>.</p>
<p>Along with the input unitary we provided two other inputs for the decomposition class.</p><ul>
<li><b>optimize_layer_num</b> Set true to try to find the fewest number of <a class="el" href="class_c_n_o_t.html" title="A class representing a CNOT operation. ">CNOT</a> gates necessary for the decomposition (increasing the running time) or false when the predefined maximal number of layer gates is used for the decomposition (which fit better for general unitaries).</li>
<li><b>initial_guess</b> String indicating the method to guess initial values for the optimization. Possible values:<ul>
<li>ZEROS: the initial guessed values are all zeros,</li>
<li>RANDOM: the initial guessed values are random doubles,</li>
<li>CLOSE_TO_ZERO: the initial guessed values are random numbers close to zero.</li>
</ul>
</li>
</ul>
<p>In case we would like to try to minimize the number of <a class="el" href="class_c_n_o_t.html" title="A class representing a CNOT operation. ">CNOT</a> gates in the decomposition, the best choice for the <b>initial_guess</b> values are <b>ZEROS</b> (discussed in more details in the forthcoming sections). However, this kind of the choice might result unwanted convergence of the optimization to local minimum instead of the global one. Thus, the solution of this example might sometimes fail to reach the global minimum. For the same reason, unitaries consisting of much <a class="el" href="class_c_n_o_t.html" title="A class representing a CNOT operation. ">CNOT</a> gates can be well decomposed by initial guess values <b>RANDOM</b> or <b>CLOSE_TO_ZERO</b>.</p>
<p>Finally, before we start the decomposition, we set some other parameters for the decomposition:</p>
<div class="snippet"> <div class="fragment"><div class="line">    <span class="comment">// setting the number of successive identical layers used in the decomposition</span></div><div class="line">    std::map&lt;int,int&gt; identical_blocks;</div><div class="line">    identical_blocks[3] = 1;</div><div class="line">    identical_blocks[4] = 2;</div><div class="line">    cDecomposition.<a class="code" href="class_n___qubit___decomposition.html#a180ca3406189b079fb2defc5054c8700">set_identical_blocks</a>( identical_blocks );</div><div class="line"></div><div class="line">    <span class="comment">// setting the maximal number of layers used in the decomposition</span></div><div class="line">    std::map&lt;int,int&gt; num_of_layers;</div><div class="line">    num_of_layers[2] = 3;</div><div class="line">    num_of_layers[3] = 16;</div><div class="line">    num_of_layers[4] = 60;</div><div class="line">    num_of_layers[5] = 240;</div><div class="line">    num_of_layers[6] = 960;</div><div class="line">    num_of_layers[7] = 3775;</div><div class="line">    cDecomposition.<a class="code" href="class_decomposition___base.html#a70fd9a8663499f135fe93cdf2ce389c0">set_max_layer_num</a>( num_of_layers );</div><div class="line"></div><div class="line">    <span class="comment">// setting the number of optimization iteration loops in each step of the decomposition</span></div><div class="line">    std::map&lt;int,int&gt; num_of_iterations;</div><div class="line">    num_of_iterations[2] = 3;</div><div class="line">    num_of_iterations[3] = 1;</div><div class="line">    num_of_iterations[4] = 1;</div><div class="line">    cDecomposition.<a class="code" href="class_decomposition___base.html#a461f735688248c8f04756e4abadb0516">set_iteration_loops</a>( num_of_iterations );</div><div class="line"></div><div class="line">    <span class="comment">// setting operation layer</span></div><div class="line">    cDecomposition.<a class="code" href="class_decomposition___base.html#af10692ec27c3db9e422d057c5f0347a6">set_optimization_blocks</a>( 1 );</div><div class="line"></div><div class="line">    <span class="comment">// setting the verbosity of the decomposition</span></div><div class="line">    cDecomposition.<a class="code" href="class_decomposition___base.html#a0a46d0f9ad1cc240256211acc30a9add">set_verbose</a>( <span class="keyword">true</span> );</div></div><!-- fragment --></div><p>By setting the number of identical blocks in the code snippet we order the code to use two identical successive blocks for the sub-disentanglement of the 4-qubit unitary:   <style>div.image img[src="layers_4qubit.png"]{width:600px;}</style>  </p><div class="image">
<img src="layers_4qubit.png" alt="layers_4qubit.png"/>
<div class="caption">
Two identical successive block in the sub-decomposition of the 4th qubit</div></div>
<p>and do not use repeated successive blocks in the decomposition of the 3-qubit submatrix:   <style>div.image img[src="layers_3qubit.png"]{width:500px;}</style>  </p><div class="image">
<img src="layers_3qubit.png" alt="layers_3qubit.png"/>
<div class="caption">
No repeated successive blocks in the sub-decomposition of the 3rd qubit</div></div>
<p>The idea behind setting two identical successive block is very straightforward. In this case the successive <a class="el" href="class_c_n_o_t.html" title="A class representing a CNOT operation. ">CNOT</a> gates might cancel each other resulting in possible simplification of the gate structure in the end of the decomposition process. Notice, that setting more the three identical blocks has no sense, since all two-qubit unitaries can be decomposed with at most three <a class="el" href="class_c_n_o_t.html" title="A class representing a CNOT operation. ">CNOT</a> gates.</p>
<p>In the second part of the code snippet above we set the maximal number of operation blocks allowed in the n-qubit sub-decomposition problem. The demonstrated choices correspond to the number of layers needed to the decomposition of general N-qubit unitaries. (These maximal parameters are in-built in the code, it is not necessary to provide them in the code.) In more specific problems the unitary might be decomposed by fewer <a class="el" href="class_c_n_o_t.html" title="A class representing a CNOT operation. ">CNOT</a> gates. In such cases we can define the upper bond of the decomposition operation blocks via these settings.</p>
<p>The third part in the above code snippet is about the setting of the number of iterations in each optimization step used during the sub-decomposition of the n-th qubit. By default, the number of iteration loops are set to one, however in case of specific unitaries, it is advised to increase the number of iteration loops to avoid unwanted convergence to local minima. (On the other hand, the increase of the iteration loops might increase the running time.) We notice, that the best choice of the above parameters varies from problem to problem. One should give a try to multiple set of parameters to find the best decomposition of the unitary.</p>
<p>In the last command of the code snippet above one can set the verbosity of the decomposition to on/off by the value True/False. After setting the parameters of the decomposition we can start the optimization process by the command:</p>
<div class="snippet"> <div class="fragment"><div class="line">    <span class="comment">// starting the decomposition</span></div><div class="line">    cDecomposition.<a class="code" href="class_n___qubit___decomposition.html#a95c12334d80bb7f2ada67c536f503494">start_decomposition</a>(<span class="comment">/* finalize_decomposition = */</span> <span class="keyword">true</span>, <span class="comment">/* prepare_export= */</span> <span class="keyword">true</span>);</div><div class="line"></div><div class="line">    cDecomposition.<a class="code" href="class_decomposition___base.html#ad897530a73bb05de35e86bf28fe40fd5">list_gates</a>(1);</div></div><!-- fragment --></div><p>The last command in the above code snippet prints the decomposing operations into the standard output. For further programming usage the list of decomposed operations can be retrieved via the method N_Qubit_Decomposition.get_operations of the class <a class="el" href="class_n___qubit___decomposition.html" title="A base class to determine the decomposition of an N-qubit unitary into a sequence of CNOT and U3 gate...">N_Qubit_Decomposition</a>.</p>
<h1>Defining custom gate structure for the decomposition</h1>
<p>The SQUANDER package is not limited to specific choice of the gates used in the decomposition. The decomposition can be executed with arbitrary, but parameter-less two-qubit controlled gates, and with a self-designed gate staructure adopted to the underlaying hardware design as well. Here we provide a simple guide on how to define custom gate structure. A working example is provided in example file <a class="el" href="custom__gate__structure__test_8cpp.html" title="A simple example file for a decomposition of general random unitaries into custom structure of U3 and...">custom_gate_structure_test.cpp</a>.</p>
<p>First we create a class that will hold the design of one period of the decomposing gate structure. (This period is then repeated in the quantum circuit.) </p><div class="snippet"> <div class="fragment"><div class="line">        <span class="comment">// creating an instance of the wrapper class Gates_block</span></div><div class="line">        <a class="code" href="class_gates__block.html">Gates_block</a>* gates_block = <span class="keyword">new</span> <a class="code" href="class_gates__block.html">Gates_block</a>( <a class="code" href="namespacesequential-quantum-gate-decomposer_1_1_c_h.html#a94a006c022e26d266fe4f6f500dda2e8">qbit_num</a> );</div></div><!-- fragment --></div><p> Then we can initialize the label of the qubit we need to disentangle. (SQUANDER always disentagles the qubit with the highes label.) </p><div class="snippet"> <div class="fragment"><div class="line">        <span class="keywordtype">int</span> disentangle_qubit = <a class="code" href="namespacesequential-quantum-gate-decomposer_1_1_c_h.html#a94a006c022e26d266fe4f6f500dda2e8">qbit_num</a> - 1;</div></div><!-- fragment --></div><p> The custom gate structure can be constructed using a for loop: </p><div class="snippet"> <div class="fragment"><div class="line">        <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> qbit=0;  qbit&lt; disentangle_qubit; qbit++ ) {</div><div class="line"></div><div class="line">            <span class="comment">// creating an instance of the wrapper class Gates_block</span></div><div class="line">            <a class="code" href="class_gates__block.html">Gates_block</a>* layer = <span class="keyword">new</span> <a class="code" href="class_gates__block.html">Gates_block</a>( <a class="code" href="namespacesequential-quantum-gate-decomposer_1_1_c_h.html#a94a006c022e26d266fe4f6f500dda2e8">qbit_num</a> );</div><div class="line"></div><div class="line">            <span class="keywordflow">if</span> (qbit == 1) {</div><div class="line"></div><div class="line">                <span class="keywordtype">int</span> target_qbit = 0;</div><div class="line">          <span class="keywordtype">int</span> control_qbit = 1;</div><div class="line"></div><div class="line">                <span class="comment">// add U3 gate to the block</span></div><div class="line">                <span class="keywordtype">bool</span> <a class="code" href="namespaceexample___q_x2.html#a97b8704a8c58c869a8ab6b4a445df065">Theta</a> = <span class="keyword">true</span>;</div><div class="line">                <span class="keywordtype">bool</span> <a class="code" href="namespaceexample___q_x2.html#a6bdd04aaf45380d1bb1001536a73007b">Phi</a> = <span class="keyword">false</span>;</div><div class="line">                <span class="keywordtype">bool</span> <a class="code" href="namespaceexample___q_x2.html#a7c4d525fad2586e5e3c6a598e69e3cb4">Lambda</a> = <span class="keyword">true</span>;</div><div class="line">                layer-&gt;<a class="code" href="class_gates__block.html#aab1d786fdac42f2d290cc4888a3bcb81">add_u3</a>( 0, Theta, Phi, Lambda );</div><div class="line">                layer-&gt;<a class="code" href="class_gates__block.html#aab1d786fdac42f2d290cc4888a3bcb81">add_u3</a>( 1, Theta, Phi, Lambda );</div><div class="line"></div><div class="line">                <span class="comment">// add CNOT gate to the block          </span></div><div class="line">                layer-&gt;<a class="code" href="class_gates__block.html#a7ad45122ea87eec9c83f29b58d76f021">add_cnot</a>( target_qbit, control_qbit );</div><div class="line"></div><div class="line"></div><div class="line">            }</div><div class="line">            <span class="keywordflow">else</span> {</div><div class="line"></div><div class="line">                <span class="keywordtype">int</span> target_qbit = qbit;</div><div class="line">          <span class="keywordtype">int</span> control_qbit = disentangle_qubit;</div><div class="line"></div><div class="line">                <span class="comment">// add U3 gate to the block</span></div><div class="line">                <span class="keywordtype">bool</span> Theta = <span class="keyword">true</span>;</div><div class="line">                <span class="keywordtype">bool</span> Phi = <span class="keyword">false</span>;</div><div class="line">                <span class="keywordtype">bool</span> Lambda = <span class="keyword">true</span>;</div><div class="line">                layer-&gt;<a class="code" href="class_gates__block.html#aab1d786fdac42f2d290cc4888a3bcb81">add_u3</a>( qbit, Theta, Phi, Lambda );</div><div class="line">                layer-&gt;<a class="code" href="class_gates__block.html#aab1d786fdac42f2d290cc4888a3bcb81">add_u3</a>( disentangle_qubit, Theta, Phi, Lambda );</div><div class="line"></div><div class="line">                <span class="comment">// add CNOT gate to the block</span></div><div class="line">                layer-&gt;<a class="code" href="class_gates__block.html#a7ad45122ea87eec9c83f29b58d76f021">add_cnot</a>( target_qbit, control_qbit );</div><div class="line">            }</div><div class="line"></div><div class="line">            gates_block-&gt;<a class="code" href="class_gates__block.html#a10f7fd8b457b825449c16231b414258c">add_gate</a>( (<a class="code" href="class_gate.html">Gate</a>*)layer );</div><div class="line"></div><div class="line">        }</div></div><!-- fragment --></div><p> In the individual layers (defined again by an instance of class <a class="el" href="class_gates__block.html" title="A class responsible for grouping two-qubit (CNOT,CZ,CH) and one-qubit gates into layers. ">Gates_block</a>) we can choose between qubits to play the role of the control and the target qubit on demand. Whatever is our choice, we should apply <a class="el" href="class_u3.html" title="A class representing a U3 gate. ">U3</a> gates to the qubits in front of the chosen two-qubit controlled gate. The <a class="el" href="class_u3.html" title="A class representing a U3 gate. ">U3</a> gates should have two free parameters, lets say variable Theta and Lambda, while parameter Phi is kept constant zero during the decompsition. (Parameters set to True are free parameters, while parameters set to False are kept constant.) In the first "if" body a connection between qubits 0 and 1 is created via a <a class="el" href="class_c_n_o_t.html" title="A class representing a CNOT operation. ">CNOT</a> gate. In particular, qubit 0 is chosen as the target qubit, and qubit 1 is chosen to be the target qubit. (The oriantation of the two-qubit controllod gates can be reversed, so the specific choice of the roles of the target and control qubits is not important in principle.)</p>
<p>The second "if" body controls the gate structure between any other qubit pairs. The created layers are added to the gates_block which can be used to decompose a quantum program. The figure below shows the period of the constructed gate structure in case of three qubits</p>
  <style>div.image img[src="custom_structure.png"]{width:600px;}</style>  </p><div class="image">
<img src="custom_structure.png" alt="custom_structure.png"/>
<div class="caption">
A custom three-qubit gate structure</div></div>
<p> We continue by creating a random 3-qubit unitary (and its transpose conjugate) by code snippet: </p><div class="snippet"> <div class="fragment"><div class="line">    <span class="comment">// The number of qubits spanning the random unitary</span></div><div class="line">    <span class="keywordtype">int</span> <a class="code" href="namespacesequential-quantum-gate-decomposer_1_1_c_h.html#a94a006c022e26d266fe4f6f500dda2e8">qbit_num</a> = 3;</div><div class="line">    <span class="comment">// the number of rows of the random unitary</span></div><div class="line">    <span class="keywordtype">int</span> <a class="code" href="namespacesequential-quantum-gate-decomposer_1_1_c_h.html#ad097cbd0876b8780bd682704cddf8691">matrix_size</a> = <a class="code" href="common_8cpp.html#a2085ad6d70ccf80dd353a70fe8262ff9">Power_of_2</a>(qbit_num);</div><div class="line">    <span class="comment">// creating class to generate general random unitary</span></div><div class="line">    <a class="code" href="class_random___unitary.html">Random_Unitary</a> ru = <a class="code" href="class_random___unitary.html">Random_Unitary</a>(matrix_size);</div><div class="line">    <span class="comment">// create general random unitary</span></div><div class="line">    <a class="code" href="class_matrix.html">Matrix</a> Umtx = ru.<a class="code" href="class_random___unitary.html#ab2efe5039bf7b2f0424d4bce4e3c66b4">Construct_Unitary_Matrix</a>();</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">// construct the complex transpose of the random unitary</span></div><div class="line">    <a class="code" href="class_matrix.html">Matrix</a> Umtx_adj = <a class="code" href="class_matrix.html">Matrix</a>(matrix_size, matrix_size);</div><div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> element_idx=0; element_idx&lt;matrix_size*<a class="code" href="namespacesequential-quantum-gate-decomposer_1_1_c_h.html#ad097cbd0876b8780bd682704cddf8691">matrix_size</a>; element_idx++) {</div><div class="line">        <span class="comment">// determine the row and column index of the element to be filled.</span></div><div class="line">        <span class="keywordtype">int</span> col_idx = element_idx % <a class="code" href="namespacesequential-quantum-gate-decomposer_1_1_c_h.html#ad097cbd0876b8780bd682704cddf8691">matrix_size</a>;</div><div class="line">        <span class="keywordtype">int</span> row_idx = int((element_idx-col_idx)/matrix_size);</div><div class="line"></div><div class="line">        <span class="comment">// setting the complex conjugate of the element in the adjungate matrix</span></div><div class="line">        <a class="code" href="struct_q_g_d___complex16.html">QGD_Complex16</a> element = Umtx[col_idx*matrix_size + row_idx];</div><div class="line">        Umtx_adj[element_idx].real = element.<a class="code" href="struct_q_g_d___complex16.html#aea2798213f363d5b681562b889ff7260">real</a>;</div><div class="line">        Umtx_adj[element_idx].imag = -element.<a class="code" href="struct_q_g_d___complex16.html#a189304d34eb9dc54e19de7eeb0b71370">imag</a>;</div><div class="line">    }</div></div><!-- fragment --></div><p> Then, we create an instance of a class to decompose the unitary </p><div class="snippet"> <div class="fragment"><div class="line">    <span class="comment">// creating the class for the decomposition. Here Umtx_adj is the complex transposition of unitary Umtx</span></div><div class="line">    <a class="code" href="class_n___qubit___decomposition.html">N_Qubit_Decomposition</a> cDecomposition =</div><div class="line">                   <a class="code" href="class_n___qubit___decomposition.html">N_Qubit_Decomposition</a>( Umtx_adj, qbit_num, <span class="comment">/* optimize_layer_num= */</span> <span class="keyword">false</span>, <span class="comment">/* initial_guess= */</span> <a class="code" href="_decomposition___base_8h.html#a0e76cf2e4eb5edbf067ba5014ffa2134aa2b65445a3a16f164c5e811064d75726">RANDOM</a> );</div></div><!-- fragment --></div><p> and we set the constructed gate structure to be used in the decomposition </p><div class="snippet"> <div class="fragment"><div class="line">    <span class="comment">// creating custom gate structure for the decomposition</span></div><div class="line">    std::map&lt;int, Gates_block*&gt; <a class="code" href="namespacesequential-quantum-gate-decomposer_1_1_c_h.html#a543a11e480f09a27d6cbb8807caa38fc">gate_structure</a>;</div><div class="line">    gate_structure.insert( pair&lt;int, Gates_block*&gt;(qbit_num, <a class="code" href="custom__gate__structure__test_8cpp.html#acc6adab67517358320294cfc3947e793">create_custom_gate_structure</a>( qbit_num ) ) );</div><div class="line">    gate_structure.insert( pair&lt;int, Gates_block*&gt;(qbit_num-1, <a class="code" href="custom__gate__structure__test_8cpp.html#acc6adab67517358320294cfc3947e793">create_custom_gate_structure</a>( qbit_num-1 ) ) );</div><div class="line"></div><div class="line">    <span class="comment">// setting the custom gate structure in the decomposition class</span></div><div class="line">    cDecomposition.<a class="code" href="class_n___qubit___decomposition.html#a67a4f9a6c179863b67b140a067f05684">set_custom_gate_structure</a>( gate_structure);</div><div class="line"></div><div class="line">    <span class="comment">// release the custom gate structure since it was cloned by cDecomposition</span></div><div class="line">    <span class="keyword">delete</span> gate_structure[<a class="code" href="namespacesequential-quantum-gate-decomposer_1_1_c_h.html#a94a006c022e26d266fe4f6f500dda2e8">qbit_num</a>];</div><div class="line">    <span class="keyword">delete</span> gate_structure[qbit_num-1];</div></div><!-- fragment --></div><p> In order to disentangle the 5-th, 4-th, 3-rd or the n-th qubit we may use different gate structure, each of them should be defined as a pair element in a C++ map gate_structure. Finally, we start to decompose the unitary and show the results. </p><div class="snippet"> <div class="fragment"><div class="line">    <span class="comment">// starting the decomposition</span></div><div class="line">    cDecomposition.<a class="code" href="class_n___qubit___decomposition.html#a95c12334d80bb7f2ada67c536f503494">start_decomposition</a>(<span class="comment">/* finalize_decomposition = */</span> <span class="keyword">true</span>, <span class="comment">/* prepare_export= */</span> <span class="keyword">true</span>);</div><div class="line"></div><div class="line">    cDecomposition.<a class="code" href="class_decomposition___base.html#ad897530a73bb05de35e86bf28fe40fd5">list_gates</a>(1);</div></div><!-- fragment --></div><h1>Compiling and linking against theSQUANDER libraries</h1>
<p>To successfuly compile a software using the SQUANDER package, one need to provide the include path of the header files for the compiler. This can be done by providing the compiler flag <b>-Ipath/to/qgd/include</b> at compilation time. After a successful installation described at <a href="index.html">Main Page</a> the header files are copied in to the <b>include</b> directory in the SQUANDER installation location.</p>
<p>Similarly, the SQUANDER libraries are installed into the directory <b>path/to/qgd/lib(64)</b>. In order to link against the installed libraries located in <b>path/to/qgd/lib(64)</b>, you must either use libtool, and specify the full pathname of the library, or use the -Lpath/to/qgd/lib(64) flag during linking and do at least one of the following:</p><ul>
<li>add path/to/qgd/lib(64) to the 'LD_LIBRARY_PATH' environment variable during execution</li>
<li>add path/to/qgd/lib(64) to the 'LD_RUN_PATH' environment variable during linking</li>
<li>use the '-Wl,-rpath -Wl,path/to/qgd/lib(64)' linker flag</li>
<li>have your system administrator add path/to/qgd/lib(64) to '/etc/ld.so.conf'</li>
</ul>
<p>Another option to build portable standalone application is to link against static library of the SQUANDER named <b>libqgd.a</b> located in the directory <b>path/to/qgd/lib(64)</b>. </p>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat Aug 28 2021 21:17:48 for Sequential Quantum Gate Decomposer by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
